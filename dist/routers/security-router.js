"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.securityRouter = void 0;
const express_1 = require("express");
const tokens_middleware_1 = require("../middlewares/tokens-middleware");
const compostion_root_1 = require("../compostion-root");
const security_controller_1 = require("../controllers/security-controller");
const securityController = compostion_root_1.container.resolve(security_controller_1.SecurityController);
exports.securityRouter = (0, express_1.Router)({});
exports.securityRouter.get('/devices', tokens_middleware_1.tokensMiddleware, securityController.getAllSessions.bind(securityController));
exports.securityRouter.delete('/devices', tokens_middleware_1.tokensMiddleware, securityController.deleteSessionsExceptOne.bind(securityController));
exports.securityRouter.delete('/devices/:deviceId', tokens_middleware_1.tokensMiddleware, securityController.deleteSessionById.bind(securityController));
